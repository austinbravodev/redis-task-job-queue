This was a personal, non-production project that I wouldn't actually use - instead, I'd use Redis Streams, which has most of this functionality out-of-the-box.
